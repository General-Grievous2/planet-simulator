<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Planet Simulator â€” N-Body Gravity</title>
  <link rel="stylesheet" href="styles.css"/>
  <!-- emoji favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸŒŒ</text></svg>"/>
</head>
<body>
  <canvas id="canvas"></canvas>

  <!-- â”€â”€ Top bar â”€â”€ -->
  <header id="topbar">
    <div id="topbar-left">
      <span id="logo">ğŸŒŒ Planet Sim</span>
    </div>
    <div id="topbar-center">
      <select id="preset-select">
        <option value="">â”€â”€â”€ Preset â”€â”€â”€</option>
        <optgroup label="ğŸŒ Solar System">
          <option value="solar-inner">Inner Solar System</option>
          <option value="solar-full">Full Solar System</option>
          <option value="earth-moon">Earthâ€“Moon</option>
        </optgroup>
        <optgroup label="â­ Multi-body">
          <option value="binary-star">Binary Stars</option>
          <option value="three-body">Figure-8 Three-Body</option>
          <option value="galaxy-collision">Galaxy Collision</option>
        </optgroup>
        <optgroup label="ğŸŒŸ JOJO'S BIZARRE PRESETS">
          <option value="jojo-roadroller">DIO's Road Roller ğŸ›£ï¸</option>
          <option value="jojo-starstruck">Star Platinum â­</option>
          <option value="jojo-requiem">Golden Requiem ğŸ‘‘</option>
          <option value="jojo-zawarudo">ZA WARUDO âŒ›</option>
        </optgroup>
      </select>
      <button id="btn-play" title="Play / Pause (Space)">â¸ Pause</button>
      <button id="btn-reset" title="Reset (R)">âŸ³ Reset</button>
      <button id="btn-add-mode" class="toggle-btn" title="Add body mode (A)">ï¼‹ Add Body</button>
    </div>
    <div id="topbar-right">
      <span id="status-bodies">0 bodies</span>
      <span id="status-time">0 s</span>
      <span id="status-energy">KE â€”</span>
    </div>
  </header>

  <!-- â”€â”€ Left panel â”€â”€ -->
  <aside id="panel-left" class="panel">

    <!-- Sim controls -->
    <h3 class="panel-title">â± Simulation</h3>
    <div class="control-group">
      <label class="ctrl-label">Time Step</label>
      <div class="row-spaced">
        <input type="range" id="dt-slider" min="0.1" max="240" step="0.1" value="6"/>
        <span id="dt-val" class="value-badge">6h/step</span>
      </div>
      <label class="ctrl-label" style="margin-top:6px;">Sub-steps (accuracy)</label>
      <div class="row-spaced">
        <input type="range" id="substeps-slider" min="1" max="60" step="1" value="10"/>
        <span id="substeps-val" class="value-badge">10x</span>
      </div>
      <label class="ctrl-label" style="margin-top:6px;">Gravity Softening</label>
      <div class="row-spaced">
        <input type="range" id="soft-slider" min="0.001" max="0.5" step="0.001" value="0.01"/>
        <span id="soft-val" class="value-badge">0.01 AU</span>
      </div>
    </div>

    <!-- Za Warudo -->
    <div class="control-group">
      <button id="btn-zawarudo" class="zawarudo-btn full-btn" title="ZA WARUDO! (Z)">âŒ› ZA WARUDO!</button>
    </div>

    <!-- Overlays -->
    <div class="control-group">
      <label class="ctrl-label">ğŸ‘ Overlays</label>
      <div class="checkbox-row"><input type="checkbox" id="chk-trails" checked/><label for="chk-trails">Trails</label></div>
      <div class="checkbox-row"><input type="checkbox" id="chk-engines"       /><label for="chk-engines">Engine arrows</label></div>
      <div class="checkbox-row"><input type="checkbox" id="chk-center"        /><label for="chk-center">Follow centre of mass</label></div>
    </div>

    <!-- Add Body -->
    <div class="control-group">
      <label class="ctrl-label">â• Add Body</label>

      <div class="template-grid">
        <label class="sub-label">Name</label>
        <input type="text" id="new-name" class="full-input" value="Planet" placeholder="DIO, Earthâ€¦"/>

        <label class="sub-label" style="grid-column:1/-1;">Mass</label>
        <div class="mass-row" style="grid-column:1/-1;">
          <input type="number" id="new-mass-val" class="full-input" value="5.972" min="0" step="any"/>
          <select id="new-mass-unit" class="unit-select">
            <option value="earth"   selected>Earth masses</option>
            <option value="solar"  >Solar masses</option>
            <option value="jupiter">Jupiter masses</option>
            <option value="moon"   >Moon masses</option>
            <option value="ton"    >Metric tons</option>
            <option value="kg"     >kg</option>
          </select>
        </div>

        <label class="sub-label">Size</label>
        <input type="range" id="new-radius" min="2" max="40" value="7" class="full-range"/>
        <span id="new-radius-val" class="value-badge" style="text-align:center;">7px</span>

        <label class="sub-label">Color</label>
        <input type="color" id="new-color" value="#4fc3f7" class="color-pick"/>
      </div>

      <div class="row-spaced" style="margin-top:8px;align-items:center;gap:6px;">
        <label class="sub-label" style="margin:0;">Vel sens.</label>
        <input type="range" id="vel-sens" min="-2" max="2" step="0.1" value="0" style="flex:1;"/>
        <span id="vel-sens-val" class="value-badge">Ã—1.0</span>
      </div>

      <label class="sub-label" style="margin-top:8px;">Quick bodies:</label>
      <div class="quick-bodies">
        <button class="quick-btn" data-quick="sun"       title="Sun">â˜€ï¸ Sun</button>
        <button class="quick-btn" data-quick="earth"     title="Earth">ğŸŒ Earth</button>
        <button class="quick-btn" data-quick="moon"      title="Moon">ğŸŒ™ Moon</button>
        <button class="quick-btn" data-quick="jupiter"   title="Jupiter">ğŸŸ¤ Jupiter</button>
        <button class="quick-btn" data-quick="black-hole" title="Black Hole">âš« BH</button>
        <button class="quick-btn" data-quick="asteroid"  title="Asteroid">ğŸª¨ Rock</button>
        <button class="quick-btn" data-quick="dio"       title="DIO ğŸ§›">ğŸ§› DIO</button>
        <button class="quick-btn" data-quick="jotaro"    title="Jotaro â­">â­ ORA</button>
      </div>

      <div id="add-hint" class="hint" style="display:none;margin-top:6px;">
        ğŸ–± <b>Click</b> canvas â†’ <b>drag</b> for velocity â†’ <b>release</b> to place!<br/>
        Press <kbd>Esc</kbd> or click button again to cancel.
      </div>
    </div>

  </aside>

  <!-- â”€â”€ Right panel: Selected body â”€â”€ -->
  <aside id="panel-right" class="panel">

    <!-- Nothing selected -->
    <div id="info-none">
      <p class="hint" style="text-align:center;padding:20px 0;">
        Click a body to select it.<br/><br/>
        Scroll to zoom Â· Right-drag to pan
      </p>
    </div>

    <!-- Body selected -->
    <div id="info-body" style="display:none;">
      <div class="panel-title-row">
        <h3 class="panel-title" id="i-name">â€”</h3>
        <button id="btn-delete" class="danger-btn" title="Delete (Del)">ğŸ—‘</button>
      </div>

      <!-- Live stats -->
      <div class="info-grid">
        <span class="info-lbl">Mass</span>    <span class="info-val" id="i-mass">â€”</span>
        <span class="info-lbl">Speed</span>   <span class="info-val" id="i-vel">â€”</span>
        <span class="info-lbl">Position</span><span class="info-val" id="i-pos">â€”</span>
        <span class="info-lbl">Distance</span><span class="info-val" id="i-orbit">â€”</span>
      </div>

      <hr class="divider"/>

      <!-- Edit -->
      <div class="control-group">
        <label class="ctrl-label">âœï¸ Edit</label>
        <label class="sub-label">Name</label>
        <input type="text" id="edit-name" class="full-input"/>

        <label class="sub-label" style="grid-column:1/-1;">Mass</label>
        <div class="mass-row" style="grid-column:1/-1;">
          <input type="number" id="edit-mass-val" class="full-input" step="any"/>
          <select id="edit-mass-unit" class="unit-select">
            <option value="earth"  >Earth masses</option>
            <option value="solar"  >Solar masses</option>
            <option value="jupiter">Jupiter masses</option>
            <option value="moon"   >Moon masses</option>
            <option value="ton"    >Metric tons</option>
            <option value="kg"     >kg</option>
          </select>
        </div>

        <label class="sub-label">Radius (px)</label>
        <div class="row-spaced">
          <input type="range" id="edit-radius" min="2" max="60" value="7" style="flex:1;"/>
          <span id="edit-radius-val" class="value-badge">7px</span>
        </div>

        <button id="btn-apply-edit" class="accent-btn full-btn" style="margin-top:6px;">âœ” Apply Changes</button>
      </div>

      <hr class="divider"/>

      <!-- Velocity -->
      <div class="control-group">
        <label class="ctrl-label">ğŸš€ Set Velocity (km/s)</label>
        <div class="row-spaced" style="gap:6px;">
          <div style="flex:1;display:flex;flex-direction:column;gap:3px;">
            <label class="sub-label">Vx</label>
            <input type="number" id="edit-vx" class="full-input" step="0.001" value="0"/>
          </div>
          <div style="flex:1;display:flex;flex-direction:column;gap:3px;">
            <label class="sub-label">Vy</label>
            <input type="number" id="edit-vy" class="full-input" step="0.001" value="0"/>
          </div>
        </div>
        <button id="btn-apply-vel" class="accent-btn full-btn" style="margin-top:5px;">âœ” Set Velocity</button>
      </div>

      <hr class="divider"/>

      <!-- Impulse / kick -->
      <div class="control-group">
        <label class="ctrl-label">ğŸ’¥ Kick Impulse (km/s)</label>
        <div class="row-spaced" style="gap:6px;">
          <div style="flex:1;display:flex;flex-direction:column;gap:3px;">
            <label class="sub-label">Î”Vx</label>
            <input type="number" id="kick-dvx" class="full-input" step="0.1" value="0"/>
          </div>
          <div style="flex:1;display:flex;flex-direction:column;gap:3px;">
            <label class="sub-label">Î”Vy</label>
            <input type="number" id="kick-dvy" class="full-input" step="0.1" value="0"/>
          </div>
        </div>
        <button id="btn-kick" class="full-btn" style="margin-top:5px;">âš¡ Apply Kick</button>
      </div>

      <hr class="divider"/>

      <!-- Engine / constant force -->
      <div class="control-group">
        <label class="ctrl-label">ğŸš€ Engine (constant force N)</label>
        <div class="row-spaced" style="gap:6px;">
          <div style="flex:1;display:flex;flex-direction:column;gap:3px;">
            <label class="sub-label">Fx</label>
            <input type="number" id="engine-fx" class="full-input" step="any" value="0"/>
          </div>
          <div style="flex:1;display:flex;flex-direction:column;gap:3px;">
            <label class="sub-label">Fy</label>
            <input type="number" id="engine-fy" class="full-input" step="any" value="0"/>
          </div>
        </div>
        <div class="row-center btn-row" style="margin-top:5px;">
          <button id="btn-engine-apply" class="accent-btn" style="flex:1;">ğŸ”´ Engage</button>
          <button id="btn-engine-off"   class="danger-btn" style="flex:1;">âœ• Off</button>
        </div>
        <span id="engine-status" class="sub-label" style="margin-top:4px;">Engine off</span>
      </div>

    </div><!-- /info-body -->
  </aside>

  <!-- Flash container for collision shouts -->
  <div id="flash-container"></div>

  <!-- Help button -->
  <button id="btn-help" title="Help (H)">?</button>

  <!-- Help modal -->
  <div id="help-modal" class="modal-overlay" style="display:none;">
    <div class="modal-box">
      <h3>ğŸŒŒ Planet Simulator â€” Help</h3>

      <h4>Mouse</h4>
      <div class="shortcut-grid">
        <kbd>Scroll</kbd>       <span>Zoom in / out</span>
        <kbd>Right-drag</kbd>   <span>Pan camera</span>
        <kbd>Click body</kbd>   <span>Select it</span>
        <kbd>Click canvas (add mode)</kbd><span>Place body</span>
        <kbd>Drag (add mode)</kbd><span>Set initial velocity</span>
      </div>

      <h4 style="margin-top:10px;">Keyboard</h4>
      <div class="shortcut-grid">
        <kbd>Space</kbd>  <span>Pause / Resume</span>
        <kbd>A</kbd>      <span>Toggle add-body mode</span>
        <kbd>R</kbd>      <span>Reset simulation</span>
        <kbd>T</kbd>      <span>Toggle trails</span>
        <kbd>Z</kbd>      <span>ZA WARUDO! âŒ› (Stop time)</span>
        <kbd>H</kbd>      <span>This help</span>
        <kbd>Esc</kbd>    <span>Deselect / cancel add</span>
        <kbd>Del</kbd>    <span>Delete selected body</span>
      </div>

      <h4 style="margin-top:10px;">JoJo Tips ğŸŒŸ</h4>
      <p class="hint">
        Name a body <b>DIO</b> â†’ it turns gold ğŸ§›<br/>
        Name a body <b>Jotaro</b> â†’ it turns blue â­<br/>
        Name a body <b>Kira/Yoshikage</b> â†’ it glows purple ğŸ’œ<br/>
        Try the JoJo preset scenes in the preset menu!<br/>
        Press <kbd>Z</kbd> or click the ZA WARUDO button to stop time!
      </p>

      <button id="btn-help-close" class="full-btn" style="margin-top:14px;">
        Close â€” YARE YARE DAZE ğŸ˜®â€ğŸ’¨
      </button>
    </div>
  </div>

  <script type="module" src="main.js"></script>
</body>
</html>
